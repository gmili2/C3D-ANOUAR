# ğŸ¨ Guide Visuel du SystÃ¨me de Rotation

## ğŸ“Š Diagrammes et Illustrations

### 1. Vue d'ensemble du systÃ¨me

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         UTILISATEUR                              â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â”‚ Clique et glisse le mtr           â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    VUE 3D (ThreeScene.vue)                â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ 1. Raycasting: Clic 3D â†’ CoordonnÃ©es UV            â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                         â”‚                                 â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ 2. Projection: UV â†’ CoordonnÃ©es 2D (pixels)        â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                         â”‚                                 â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ 3. DÃ©tection: Distance curseur â†” mtr â‰¤ 10px ?     â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                         â”‚                                 â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ 4. Calcul: Angle de rotation (atan2)              â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                         â”‚                                 â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ 5. Ã‰mission: Ã‰vÃ©nement '3d-rotation'              â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â”‚ Ã‰vÃ©nement avec angle              â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              VUE 2D (DesignStudio.vue)                    â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ 1. RÃ©ception de l'Ã©vÃ©nement                        â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                         â”‚                                 â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ 2. Application: object.rotate(angle)               â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                         â”‚                                 â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ 3. Rendu: canvas.renderAll()                       â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â”‚ Mise Ã  jour visuelle              â”‚
â”‚                              â–¼                                   â”‚
â”‚                         UTILISATEUR                              â”‚
â”‚                    (voit l'objet tourner)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 2. ContrÃ´le mtr et zone de dÃ©tection

```
                    â†‘ mtr (middle-top-rotate)
                    â”‚
                    â— â† ContrÃ´le de rotation
                   â•±â”‚â•²
                  â•± â”‚ â•²
                 â•±  â”‚  â•²
                â•±   â”‚   â•²
               â•±    â”‚    â•²
              â•±     â”‚     â•²
             â•±      â”‚      â•²
            â•±       â”‚       â•²
           â•±        â”‚        â•²
          â•±         â”‚         â•²
         â•±          â”‚          â•²
        â•±           â”‚           â•²
       â•±            â”‚            â•²
      â•±             â”‚             â•²
     â•±              â”‚              â•²
    â•±               â”‚               â•²
   â•±                â”‚                â•²
  â•±                 â”‚                 â•²
 â•±                  â”‚                  â•²
â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—
tl                                      tr
â”‚                                       â”‚
â”‚          Ã‰LÃ‰MENT SÃ‰LECTIONNÃ‰          â”‚
â”‚                                       â”‚
â”‚                                       â”‚
â”‚                                       â”‚
â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—
bl                                      br

LÃ©gende:
â— = ContrÃ´les de l'objet (coins + mtr)
tl = top-left (coin supÃ©rieur gauche)
tr = top-right (coin supÃ©rieur droit)
bl = bottom-left (coin infÃ©rieur gauche)
br = bottom-right (coin infÃ©rieur droit)
mtr = middle-top-rotate (contrÃ´le de rotation)

Zone de dÃ©tection du mtr:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Rayon de dÃ©tection:       â”‚
â”‚   - Clic: 10 pixels         â”‚
â”‚   - Hover: 20 pixels        â”‚
â”‚                             â”‚
â”‚        â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®          â”‚
â”‚       â•±           â•²         â”‚
â”‚      â”‚      â—      â”‚        â”‚ â† Zone de 20px (hover)
â”‚       â•²           â•±         â”‚
â”‚        â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯          â”‚
â”‚          â•­â”€â”€â”€â•®              â”‚
â”‚          â”‚ â— â”‚              â”‚ â† Zone de 10px (clic)
â”‚          â•°â”€â”€â”€â•¯              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3. Calcul du centre gÃ©omÃ©trique

#### MÃ©thode 1: Intersection des diagonales

```
Avant rotation:                  AprÃ¨s rotation:

    tl â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â— tr               tl â—â•²
       â”‚         â”‚                      â”‚ â•²
       â”‚    â—    â”‚                      â”‚  â•²
       â”‚  CENTER â”‚                      â”‚   â— tr
       â”‚         â”‚                      â”‚  â•±
    bl â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â— br                  â”‚ â•±
                                       â”‚â•±
                                    bl â—
                                        â•²
                                         â•²
                                          â— br

Dans les deux cas, le centre est Ã  l'intersection des diagonales:
- Diagonale 1: tl â†’ br
- Diagonale 2: tr â†’ bl

Formule d'intersection:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ denom = (xâ‚-xâ‚‚)(yâ‚ƒ-yâ‚„) - (yâ‚-yâ‚‚)(xâ‚ƒ-xâ‚„)                â”‚
â”‚ t = [(xâ‚-xâ‚ƒ)(yâ‚ƒ-yâ‚„) - (yâ‚-yâ‚ƒ)(xâ‚ƒ-xâ‚„)] / denom          â”‚
â”‚ centerX = xâ‚ + t(xâ‚‚-xâ‚)                                 â”‚
â”‚ centerY = yâ‚ + t(yâ‚‚-yâ‚)                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

OÃ¹:
- (xâ‚,yâ‚) = tl (top-left)
- (xâ‚‚,yâ‚‚) = br (bottom-right)
- (xâ‚ƒ,yâ‚ƒ) = tr (top-right)
- (xâ‚„,yâ‚„) = bl (bottom-left)
```

---

### 4. Calcul de l'angle avec atan2

```
SystÃ¨me de coordonnÃ©es:

              -90Â° (haut)
                  â†‘
                  â”‚
                  â”‚
-180Â° â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ 0Â° (droite)
(gauche)          â”‚ CENTER
                  â”‚
                  â”‚
                  â†“
               90Â° (bas)


Exemple de rotation:

Position initiale du curseur:        Position actuelle du curseur:
                                    
        â—                                   â—
      CENTER                              CENTER
         â•²                                  â”‚
          â•²                                 â”‚
           â•²                                â”‚
            â— curseur                       â— curseur
         
startAngle = 45Â°                    currentAngle = 90Â°
(atan2 du vecteur)                  (atan2 du vecteur)

DiffÃ©rence d'angle:
angleDelta = currentAngle - startAngle
angleDelta = 90Â° - 45Â° = 45Â°

â†’ L'objet a tournÃ© de 45Â° dans le sens anti-horaire
```

---

### 5. Normalisation de l'angle

```
ProblÃ¨me des angles non normalisÃ©s:

Cas 1: Passage de 170Â° Ã  -170Â°
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Sans normalisation:                                     â”‚
â”‚ angleDelta = -170Â° - 170Â° = -340Â°                      â”‚
â”‚ â†’ Rotation de 340Â° dans le sens horaire (INCORRECT)    â”‚
â”‚                                                         â”‚
â”‚ Avec normalisation:                                     â”‚
â”‚ angleDelta = -340Â°                                      â”‚
â”‚ angleDelta < -180 â†’ angleDelta += 360                  â”‚
â”‚ angleDelta = -340Â° + 360Â° = 20Â°                        â”‚
â”‚ â†’ Rotation de 20Â° dans le sens anti-horaire (CORRECT)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Cas 2: Passage de -170Â° Ã  170Â°
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Sans normalisation:                                     â”‚
â”‚ angleDelta = 170Â° - (-170Â°) = 340Â°                     â”‚
â”‚ â†’ Rotation de 340Â° dans le sens anti-horaire (INCORRECT)â”‚
â”‚                                                         â”‚
â”‚ Avec normalisation:                                     â”‚
â”‚ angleDelta = 340Â°                                       â”‚
â”‚ angleDelta > 180 â†’ angleDelta -= 360                   â”‚
â”‚ angleDelta = 340Â° - 360Â° = -20Â°                        â”‚
â”‚ â†’ Rotation de 20Â° dans le sens horaire (CORRECT)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Visualisation du cercle trigonomÃ©trique:

         -90Â°
          â†‘
          â”‚
          â”‚
-180Â° â”€â”€â”€â”€â—â”€â”€â”€â”€ 0Â°
    â†‘     â”‚     â†‘
    â”‚     â”‚     â”‚
    â”‚     â†“     â”‚
  170Â°   90Â°  -170Â°
    â”‚           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      Passage direct
      = 20Â° (normalisÃ©)
```

---

### 6. Timeline d'une rotation complÃ¨te

```
Temps â†’

T0: Clic sur le mtr
â”‚
â”œâ”€ isRotating3D = false
â”œâ”€ DÃ©tection: distance â‰¤ 10px
â”œâ”€ isRotating3D = true
â”œâ”€ Enregistrement: rotationStartPosition, rotationStartCursor
â”œâ”€ DÃ©sactivation: OrbitControls.enabled = false
â””â”€ Ã‰mission: '3d-rotation-start'
â”‚
â”‚
T1: Mouvement de la souris (frame 1)
â”‚
â”œâ”€ Calcul du centre gÃ©omÃ©trique
â”œâ”€ Calcul de startAngle (position initiale)
â”œâ”€ Calcul de currentAngle (position actuelle)
â”œâ”€ Calcul de angleDelta = currentAngle - startAngle
â”œâ”€ Normalisation de angleDelta
â””â”€ Ã‰mission: '3d-rotation' { angle: angleDelta }
â”‚
â”‚
T2: Mouvement de la souris (frame 2)
â”‚
â”œâ”€ Calcul du centre gÃ©omÃ©trique
â”œâ”€ Calcul de startAngle (position initiale - inchangÃ©e)
â”œâ”€ Calcul de currentAngle (nouvelle position)
â”œâ”€ Calcul de angleDelta = currentAngle - startAngle
â”œâ”€ Normalisation de angleDelta
â””â”€ Ã‰mission: '3d-rotation' { angle: angleDelta }
â”‚
â”‚
... (frames suivantes)
â”‚
â”‚
Tn: RelÃ¢chement de la souris
â”‚
â”œâ”€ Ã‰mission: '3d-rotation-end'
â”œâ”€ isRotating3D = false
â”œâ”€ rotationStartPosition = null
â”œâ”€ rotationStartCursor = null
â”œâ”€ rotationJustEnded = true
â”œâ”€ rotationEndTime = Date.now()
â”œâ”€ RÃ©activation: OrbitControls.enabled = true
â”œâ”€ Restauration du curseur
â””â”€ setTimeout(() => rotationJustEnded = false, 200)
â”‚
â”‚
Tn+200ms: Fin du dÃ©lai de protection
â”‚
â””â”€ rotationJustEnded = false
   (PrÃªt pour une nouvelle rotation)
```

---

### 7. Machine Ã  Ã©tats de la rotation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Ã‰TAT INITIAL                          â”‚
â”‚                                                              â”‚
â”‚  isRotating3D = false                                        â”‚
â”‚  rotationStartPosition = null                                â”‚
â”‚  rotationStartCursor = null                                  â”‚
â”‚  rotationJustEnded = false                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â”‚ Ã‰vÃ©nement: Clic sur mtr
                       â”‚ Condition: distance â‰¤ 10px
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ROTATION ACTIVE                           â”‚
â”‚                                                              â”‚
â”‚  isRotating3D = true                                         â”‚
â”‚  rotationStartPosition = { x, y }                            â”‚
â”‚  rotationStartCursor = { x, y }                              â”‚
â”‚  rotationJustEnded = false                                   â”‚
â”‚                                                              â”‚
â”‚  Actions:                                                    â”‚
â”‚  - DÃ©sactiver OrbitControls                                  â”‚
â”‚  - Ã‰mettre '3d-rotation-start'                               â”‚
â”‚  - Calculer et Ã©mettre '3d-rotation' Ã  chaque frame         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â”‚ Ã‰vÃ©nement: RelÃ¢chement souris
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ROTATION TERMINÃ‰E                           â”‚
â”‚                  (Protection active)                         â”‚
â”‚                                                              â”‚
â”‚  isRotating3D = false                                        â”‚
â”‚  rotationStartPosition = null                                â”‚
â”‚  rotationStartCursor = null                                  â”‚
â”‚  rotationJustEnded = true                                    â”‚
â”‚  rotationEndTime = Date.now()                                â”‚
â”‚                                                              â”‚
â”‚  Actions:                                                    â”‚
â”‚  - Ã‰mettre '3d-rotation-end'                                 â”‚
â”‚  - RÃ©activer OrbitControls                                   â”‚
â”‚  - Restaurer le curseur                                      â”‚
â”‚  - DÃ©marrer le timer de protection (200ms)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â”‚ Ã‰vÃ©nement: Timer Ã©coulÃ© (200ms)
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Ã‰TAT INITIAL                          â”‚
â”‚                  (PrÃªt pour nouvelle rotation)               â”‚
â”‚                                                              â”‚
â”‚  isRotating3D = false                                        â”‚
â”‚  rotationStartPosition = null                                â”‚
â”‚  rotationStartCursor = null                                  â”‚
â”‚  rotationJustEnded = false                                   â”‚
â”‚  rotationEndTime = timestamp                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 8. Exemple concret avec valeurs numÃ©riques

```
SCÃ‰NARIO: Rotation d'une image de 45Â°

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰TAPE 1: Configuration initiale                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Objet sÃ©lectionnÃ©: Image "logo.png"                         â”‚
â”‚ Position: left=300, top=200                                  â”‚
â”‚ Dimensions: width=200, height=100                            â”‚
â”‚ Angle actuel: 0Â°                                             â”‚
â”‚                                                              â”‚
â”‚ ContrÃ´les:                                                   â”‚
â”‚ - tl: (300, 200)                                             â”‚
â”‚ - tr: (500, 200)                                             â”‚
â”‚ - bl: (300, 300)                                             â”‚
â”‚ - br: (500, 300)                                             â”‚
â”‚ - mtr: (400, 170)  â† 30px au-dessus du centre               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰TAPE 2: Clic sur le mtr                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Curseur: (405, 175)                                          â”‚
â”‚ mtr: (400, 170)                                              â”‚
â”‚                                                              â”‚
â”‚ Calcul de distance:                                          â”‚
â”‚ distance = âˆš[(405-400)Â² + (175-170)Â²]                       â”‚
â”‚ distance = âˆš[25 + 25]                                        â”‚
â”‚ distance = âˆš50 â‰ˆ 7.07 pixels                                â”‚
â”‚                                                              â”‚
â”‚ 7.07 â‰¤ 10 â†’ DÃ‰TECTION POSITIVE                              â”‚
â”‚                                                              â”‚
â”‚ Actions:                                                     â”‚
â”‚ - isRotating3D = true                                        â”‚
â”‚ - rotationStartPosition = { x: 400, y: 170 }                â”‚
â”‚ - rotationStartCursor = { x: 405, y: 175 }                  â”‚
â”‚ - Ã‰mission: '3d-rotation-start'                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰TAPE 3: Calcul du centre gÃ©omÃ©trique                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ MÃ©thode: Intersection des diagonales                        â”‚
â”‚                                                              â”‚
â”‚ Diagonale 1: tl(300,200) â†’ br(500,300)                     â”‚
â”‚ Diagonale 2: tr(500,200) â†’ bl(300,300)                     â”‚
â”‚                                                              â”‚
â”‚ Calculs:                                                     â”‚
â”‚ x1=300, y1=200, x2=500, y2=300                              â”‚
â”‚ x3=500, y3=200, x4=300, y4=300                              â”‚
â”‚                                                              â”‚
â”‚ denom = (300-500)(200-300) - (200-300)(500-300)             â”‚
â”‚ denom = (-200)(-100) - (-100)(200)                          â”‚
â”‚ denom = 20000 + 20000 = 40000                               â”‚
â”‚                                                              â”‚
â”‚ t = [(300-500)(200-300) - (200-200)(500-300)] / 40000      â”‚
â”‚ t = [(-200)(-100) - 0] / 40000                              â”‚
â”‚ t = 20000 / 40000 = 0.5                                     â”‚
â”‚                                                              â”‚
â”‚ centerX = 300 + 0.5(500-300) = 300 + 100 = 400              â”‚
â”‚ centerY = 200 + 0.5(300-200) = 200 + 50 = 250               â”‚
â”‚                                                              â”‚
â”‚ Centre: (400, 250)                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰TAPE 4: Mouvement de la souris                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Curseur actuel: (450, 200)                                   â”‚
â”‚                                                              â”‚
â”‚ Calcul de startAngle:                                        â”‚
â”‚ startDx = 405 - 400 = 5                                      â”‚
â”‚ startDy = 175 - 250 = -75                                    â”‚
â”‚ startAngle = atan2(-75, 5) Ã— (180/Ï€)                        â”‚
â”‚ startAngle â‰ˆ -86.19Â°                                         â”‚
â”‚                                                              â”‚
â”‚ Calcul de currentAngle:                                      â”‚
â”‚ currentDx = 450 - 400 = 50                                   â”‚
â”‚ currentDy = 200 - 250 = -50                                  â”‚
â”‚ currentAngle = atan2(-50, 50) Ã— (180/Ï€)                     â”‚
â”‚ currentAngle = -45Â°                                          â”‚
â”‚                                                              â”‚
â”‚ Calcul de angleDelta:                                        â”‚
â”‚ angleDelta = -45Â° - (-86.19Â°)                               â”‚
â”‚ angleDelta = 41.19Â°                                          â”‚
â”‚                                                              â”‚
â”‚ Normalisation: 41.19Â° est entre -180Â° et 180Â° â†’ OK          â”‚
â”‚                                                              â”‚
â”‚ Ã‰mission: '3d-rotation' { angle: 41.19 }                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰TAPE 5: Application de la rotation                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DesignStudio.vue reÃ§oit l'Ã©vÃ©nement:                        â”‚
â”‚ { angle: 41.19, canvasX: 450, canvasY: 200 }               â”‚
â”‚                                                              â”‚
â”‚ Application:                                                 â”‚
â”‚ selectedObject.rotate(41.19)                                 â”‚
â”‚ canvas.renderAll()                                           â”‚
â”‚                                                              â”‚
â”‚ RÃ©sultat:                                                    â”‚
â”‚ L'image tourne de 41.19Â° autour de son centre               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰TAPE 6: RelÃ¢chement de la souris                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Actions:                                                     â”‚
â”‚ - Ã‰mission: '3d-rotation-end'                                â”‚
â”‚ - isRotating3D = false                                       â”‚
â”‚ - rotationStartPosition = null                               â”‚
â”‚ - rotationStartCursor = null                                 â”‚
â”‚ - rotationJustEnded = true                                   â”‚
â”‚ - rotationEndTime = 1700000000000 (exemple)                 â”‚
â”‚ - OrbitControls.enabled = true                               â”‚
â”‚                                                              â”‚
â”‚ Timer de 200ms dÃ©marrÃ© pour rÃ©initialiser rotationJustEnded â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 9. Gestion des erreurs et cas limites

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CAS 1: Diagonales parallÃ¨les (trÃ¨s rare)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ProblÃ¨me: denom â‰ˆ 0 (division par zÃ©ro)                    â”‚
â”‚                                                              â”‚
â”‚ Solution: Fallback sur la moyenne des 4 coins               â”‚
â”‚                                                              â”‚
â”‚ if (Math.abs(denom) > 0.001) {                              â”‚
â”‚   // MÃ©thode normale                                        â”‚
â”‚ } else {                                                     â”‚
â”‚   centerX = (tl.x + tr.x + bl.x + br.x) / 4                â”‚
â”‚   centerY = (tl.y + tr.y + bl.y + br.y) / 4                â”‚
â”‚ }                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CAS 2: ContrÃ´les non disponibles                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ProblÃ¨me: controls.tl/tr/bl/br n'existent pas              â”‚
â”‚                                                              â”‚
â”‚ Solution: Calcul via left/top/width/height                  â”‚
â”‚                                                              â”‚
â”‚ if (controls.tl && controls.tr && ...) {                    â”‚
â”‚   // MÃ©thode par intersection                               â”‚
â”‚ } else {                                                     â”‚
â”‚   // MÃ©thode par dimensions                                 â”‚
â”‚   centerX = left + width/2                                   â”‚
â”‚   centerY = top + height/2                                   â”‚
â”‚   // (avec ajustement selon originX/originY)                â”‚
â”‚ }                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CAS 3: Clic immÃ©diat aprÃ¨s rotation                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ProblÃ¨me: Faux positif lors du relÃ¢chement                  â”‚
â”‚                                                              â”‚
â”‚ Solution: Protection anti-rebond                             â”‚
â”‚                                                              â”‚
â”‚ const timeSinceRotationEnd = Date.now() - rotationEndTime  â”‚
â”‚ if (!rotationJustEnded &&                                    â”‚
â”‚     timeSinceRotationEnd > 100) {                           â”‚
â”‚   // On peut dÃ©tecter une nouvelle rotation                 â”‚
â”‚ }                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CAS 4: Angle > 180Â° ou < -180Â°                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ProblÃ¨me: Sauts brusques dans la rotation                   â”‚
â”‚                                                              â”‚
â”‚ Solution: Normalisation                                      â”‚
â”‚                                                              â”‚
â”‚ if (angleDelta > 180) angleDelta -= 360                     â”‚
â”‚ if (angleDelta < -180) angleDelta += 360                    â”‚
â”‚                                                              â”‚
â”‚ Exemple:                                                     â”‚
â”‚ angleDelta = 270Â° â†’ 270 - 360 = -90Â°                        â”‚
â”‚ (rotation de 90Â° dans le sens horaire)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ RÃ©sumÃ© visuel

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SYSTÃˆME DE ROTATION                        â”‚
â”‚                                                               â”‚
â”‚  1. DÃ‰TECTION                                                 â”‚
â”‚     â””â”€ Distance curseur â†” mtr â‰¤ 10px                         â”‚
â”‚                                                               â”‚
â”‚  2. ACTIVATION                                                â”‚
â”‚     â”œâ”€ isRotating3D = true                                    â”‚
â”‚     â”œâ”€ Enregistrement positions                               â”‚
â”‚     â””â”€ Ã‰mission '3d-rotation-start'                           â”‚
â”‚                                                               â”‚
â”‚  3. CALCUL                                                    â”‚
â”‚     â”œâ”€ Centre gÃ©omÃ©trique (intersection diagonales)           â”‚
â”‚     â”œâ”€ Angles (atan2)                                         â”‚
â”‚     â”œâ”€ Delta (diffÃ©rence normalisÃ©e)                          â”‚
â”‚     â””â”€ Ã‰mission '3d-rotation' { angle }                       â”‚
â”‚                                                               â”‚
â”‚  4. APPLICATION                                               â”‚
â”‚     â”œâ”€ RÃ©ception Ã©vÃ©nement (DesignStudio)                     â”‚
â”‚     â”œâ”€ object.rotate(angle)                                   â”‚
â”‚     â””â”€ canvas.renderAll()                                     â”‚
â”‚                                                               â”‚
â”‚  5. FINALISATION                                              â”‚
â”‚     â”œâ”€ Ã‰mission '3d-rotation-end'                             â”‚
â”‚     â”œâ”€ RÃ©initialisation variables                             â”‚
â”‚     â””â”€ Protection anti-rebond (200ms)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Document crÃ©Ã© le**: 2025-11-19  
**Auteur**: Guide visuel du systÃ¨me de rotation  
**Version**: 1.0
